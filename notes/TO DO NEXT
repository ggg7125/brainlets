THIS ILLUSTRATES WHY IT IS VERY IMPORTANT TO RELY ON THE AUTHORITY AS LITTLE AS POSSIBLE. THE AUTHORITY SHOULD INSTEAD INFORM THE RELAY SERVER CONSTANTLY OF ALL RELEVENT CHANGES AND THE SERVER WILL THEN BE ABLE TO RELIABLY TELL WHOEVER NEEDS IT. DON'T DELETE THIS ITS IMPORTANT. (i erased what it is referring to that illustrates the problem but trust me, you need to know this. extremely important)

CURRENT AGENDA:
    finish the playerBoss.js system
    ---
    so just let the players kill each other over a jewel of power or something and you are golden
        add to radar - the jewel or who has it depending on context

    make shotgun an ability - heavy knockback - fightz does not have shotguns
        the projectile can look like a set of streamer things like in that other io game i think shootz.io maybe idk
    ---
    add gore - people explode into blood when they die
        and zombies too
        the du blood graphics might somehow work we got quite a few of them to choose from if i remember correctly

    ESSENTIALS TO LAUNCH THE GAME
        https certificate & real domain name
        people using adblock should level like 1.5x slower - show a message saying theyll level faster with adblock off - or make them gain xp for watching an ad
        ads
            put an ad on the title screen in a box to the left of the enter name box like fightz.io has
            when they die show an ad
        account login registration system - we need this for IAP - fightz is really simple theres not even need for verification

    FINISH WHAT FIGHTZ HAS THAT WE DONT HAVE BEFORE GOING ON TO ANYTHING ELSE
        leaderboard - not necessary to launch
        attacks that can knockback npcs
        biomes - fightz biomes have different color rocks, ground, and such
            TONS OF OTHER SIMILAR IO GAMES DONT HAVE BIOMES - I DONT THINK WE NEED THIS TO LAUNCH
            miasma biome (poison purple smog - undead creatures)
            all-water island biome
            grass
            desert
            snow
        facebook/twitter/reddit/discord/youtube buttons - yes fightz has all these, just look at it for how to lay it out
        casual or pvp mode - i dont think we need this, especially not to launch the game

IDEAS FOR WHAT STATS DO:
    power - more damage - more drain
    durability - take less damage - but not less shield damage (see spirit)
    speed - move faster - attack faster
    stamina - used for abilities - resist stam drain attacks - does NOT lower buff drain (leave that for vitality)
    vitality - heal faster - stay buffed longer - resist bleed damage - resist poison - gain xp faster? - recover stam slightly faster?
    spirit - see farther - more projectile range! - heal faster only when standing still - resist stun - resist fear - stronger shield - gain power as health & stamina decreases (resolve is part of spirit) - gain passive xp - gain xp faster - stay buffed longer
    POSSIBILITIES TO ASSIGN TO ANY STAT WE FEEL LIKE:
        stay buffed longer
        see farther
        bigger AoEs
        bigger explosions (power?)
-----------
LOG OF WHAT STATS CURRENTLY DO - THIS STUFF IS ACTUALLY CODED IN RIGHT NOW:
    power - more damage - more drain
    durability - take less damage
    speed - move faster - attack faster
    stamina - drains
    vitality - heal faster
    spirit - see further - more bullet range - gain passive xp

ADVICE:
    TAKE A LOOK AT SHOOTZ.IO - ITS WHAT THE GUY MADE BEFORE FIGHTZ.IO I THINK - MUCH SIMPLER BUT SO MANY PEOPLE STILL PLAY IT

'Team' ideas
    If its a 2-team game (so you have allies on your side automatically) then each side has a 'King'. if you as a player kill the king of the other tribe you become king of your tribe overruling the current king of your tribe. - this idea could be used instead of the 'king of the hill' magic jewel crown whatever idea that grants immense power to 1 person.
---
'Good and Evil' ideas
    instead of 2-teams, have everyone be good by default (blue name), if they kill any other good person, they become evil (red name). though perhaps only for 5-10 minutes.

zombie attacks should poison you
---
there should be an npc or bush/tree you can destroy that drops a poison antidote in a certain biome. i'd say a cactus or something - 25% chance of drop from cactus destroy
    
in fightz, npcs walk right through bushes/rocks/etc, something to consider, since our npcs keep getting stuck

certain abilities you equip should slow you down because of their weight like if you equip a big sledge hammer or something

dont let people under 30 fps become authority

explosives on the map that if you shoot or bump (from knockback for example) it explodes

dont let people with bad internet become authority

server.js should automatically reboot itself every like, 48 hours, to clear out all the memory because theres probably leaks in storedData or who knows but either way

get our domain (myiotestdomain.club on namecheap.com) certified so the https certificate is trusted and then host it on our vps or something. https certs are only trusted using domain urls they are never trusted connecting to an IP. self signed certs are useless.

dont auto-refresh a client after the inactivity timeout if they are on the title screen, only in the game scene. the auto-refresh code is in authority.js

on the title screen put a UI explaining the controls WASD + Mouse and how to play basics like fightz

its unimmersive when wolves (and any predator) attacks you but never attacks a deer or anything that is closer to it
        aka: any npc that is baseAggressive should be able to target any other species around it as well as players, all depends on distance

aura mode - more power but things drain you faster
    should it be a special ability that you must pick over others on the 2 mouse buttons?

dash

IMPORTANT: range netvars dont even need to send a list of receivers, or do a range check. if any time the server receives a netvar update relating to the x/y/angle for someone with a given range, it sets the server's socket.x, socket.y, and socket.angle vars on the server to that latest value. the server then checks if that socket is in range of the sending socket. and sends out the emit to those who are.

'main weapon' idea: LMB ability could be considered 'main' ability and be stronger than secondary abilities.
    its kind of cool because, you could assign melee to LMB and shield to RMB, but if someone chose to do the reverse, their shield would be stronger instead.
        the 'main' ability would be say, 35% stronger than the others for example.

MAGICAL HATS - THEY ARE THEMED HATS OFTEN REPRESENTING PARTICULAR INTERESTS OR POPULAR CULTURE
    Forget the concept of armor. Instead there are MAGICAL HATS, some of which encompass armor (such as Warrior Helmet) and some are just off-the-wall anything goes because magic.
    basically all hats have special attributes to make them cool unique and interesting. that's all.
IDEAS FOR HATS - basically they are references to popular culture:
    Robinhood Hat somehow makes you better at archery dont question it
    Pirate Hat = more power at sea and more money
    Warrior Helmet = take less damage - its just armor
    Goku hair hat = maybe gives a ss blue transformation or shoot a big beam idk
    Naruto hat
    Kings Crown
    Vampire Hat
Some hats provide much needed extra abilities, which are assigned on the 0-9 keys, for example Goku hair probably has ss blue and kaioken (and you can stack both)
    most hats would provide just 1 extra ability at most, most hats probably dont have an extra ability but just passive attributes

destroy trees/rocks - they shrink as you hit them then explode into shards of wood/rock

leaderboard

stamina for attacking evading etc?

the map is really empty theres only trees/rocks/bushes/water here are ideas NEW NPCS AND OBJECTS OF ANY KIND - IF IT GOES ON THE MAP, HERES AN IDEA FOR IT:
    treasure chests or otherwise equivelents where you break them and get something nice
    poison mushrooms
    health refill items (fruits, chicken, idk)
    xp boost drops
    something that explodes if you collide with it (a wandering small insect npc that does not attack but explodes if touched - to be avoided)

make rocks/bushes/trees delete themselves if they spawn on water

ads

favicon

loading bar could easily be replaced with the same concept as our html health bar code and look much better

break map into zones: desert, grasslands, arctic, deadlands, clownland etc

players heal fast at spawn for players who havent upgraded their healing at all. or if theyre on a weapon pad or spawn or whatever place idk

npc spawning is in the wrong place. it spawns more npcs every time authority changes. put it in the right place and finish it more

eventually, put a bigger selection of title music. but only load 1 at random or base which gets loaded on time of day or something so we dont have to download them all just to play. it just serves you 1.
itll spice up the feel of the game if the title music changes itself every once in a while.
it wont increase file size at all because we only load 1 of the songs.

make emits that still arent using enum tags instead of string tags use the enum tags

odds are these socket/room lookups (where we have like a socketId and have to loop through a bunch of entities to find which Player object represents that socketId) etc using for() loops and such are gonna be pretty intensive but we found the SOLUTION: (we can do it later though, for now move on):
we found we can create new variables directly on the socket, we have done this for some things, like socket.roomObject = room, socket.playerObject = player, etc, so we need to just create new variables on things instead of having to intensively look it up every single time, this takes it from very intensive to not very intensive at all if the references we need are already stored where they need to be

send the starting position of new players along with them bcause the whole pop-in lerp to the latest update thing is not good
they spawn at 0,0 currently then lerp fast to whatever new update comes in

make players trigger an npc's ai instead of their ai constantly trying to find a player? more efficient massively. more so because instead of every NPC on the authority constantly looking for a target, we divide the work to happen on each player's local side. each player can range-check if an npc is near them locally, then send an emit to activate that npc on the authority. greatly reduces authority's cpu strain. but that extra emit is not nice...maybe its fine if every player on the authority does the range-check there to activate the npc without sending any emits

we should give players savefiles but have them expire if not used for 24 hours so that our database size is small
    or save locally idk
        local save could work for the current session. BrutalMania.io has local saving so if you leave the tab and come back you keep your progress. but that's a single player game (although it is designed to appear multiplayer)
FOR IN-APP PURCHASES WE WILL NEED SOME KIND OF SAVING - OTHERWISE HOW WILL THEY KEEP WHAT THEY BUY?
THEY WILL ALSO NEED TO REGISTER AN ACCOUNT.
MAYBE WE DO GIVE THEM A SAVE IN OUR OWN DATABASE BUT ONLY FOR THOSE WHO HAVE REGISTERED AN ACCOUNT - NOT EVERY RANDOM GUEST WHO LOGS ON THEN LEAVES NEVER TO RETURN GETS A SAVE, ONLY SERIOUS PLAYERS WHO BOTHER MAKING AN ACCOUNT.

minimap (if we even want one)

socket.io has automatic reconnects, but you can disable it - we need to figure out what problems we face with automatic reconnects. i think bad things will happen from them.
    perhaps keep it simple and just refresh their page to send them back to the title screen with a 'connection lost try again' message
        figure out a better way later maybe but for now move on

make a visibility system - where sprites out of range of receiving movement updates disappear
    EASIER BETTER IDEA:
        for now, for rapid development, we can limit the bandwidth of all players sending to all players, by simply massively slowing down the rate of position updates the further players get from you
        example: on your screen they send at 50 ms, twice that distance its 100 ms, twice that distance 200 ms, twice that 400 ms, then keep going til we cap out at about 2000 ms
            so as you can see players sending updates to everyone at 2000 ms instead of 50 ms is 40x less bandwidth, it should be fine we can worry about detailed visibility systems after the rest of the core game is done and deployed
    Do we even need a visibility system if we are just using SendInRange for most of those things? SendInRange only sends data like that to people who need it anyway

unified move system: make all npcs and players use the same core movement system on the authority. a unified wrapper for moving objects

add social aspects, not just a random killfest
    you choose a faction? red vs blue etc. so you got people on your side automatically who are no threat to you and you can pal around with
        having absolutely everyone be a threat to you really sucks imo

optimizations
    ez: lower max room count is bandwidth usage is too high, because of the squared nature of all players sending packets to all players, you get 10x10 = 100 compared to 20x20 = 400.

    find reasons to keep players spread out because with SendInRange the more players that are near every other player the data goes up squared. so if every player was at the spawn its no better than sending everyone's packet to everyone at once, 20x20 players, because theyre all within sight of each other! crowds eat bandwidth like crazy!

    instead of sending hashId we can use spriteId for some messages cant we? because spriteIds match on all sides. and if the authority is using it its trustable we dont need some hashId, just give it to whatever sprite is supposed to have it, no hashId needed, hashId is 4 bytes but spriteId is 1-2 bytes

    send as binary schema like zeex? he says binary schema just turns json into binary and lets you deconvert it back to json and it saves data. this seems to offer some security becuase right now i can just press F12 and see all the packets for exactly what they really are, like [posUpdate, 1342, 9374] and someone could use this to send falsified packets easily

    instead of sending a packet for pos and a packet for ang, combine them when possible. because a blank emit is 5 bytes. we have ang updates at 9 and pos updates at 15. i tested it using socket.emit(5, [3000, 3000, 120]) to simulate [x, y, ang] and it was 21 bytes. whereas 15 + 9 is 24 bytes. a savings of 3 bytes but its something we can do later

    optimization for sending arrays of socketIds: a socketId sent using utils.HashCode() is 4 bytes, but we can also send using their reusable player index within their room (0-255 identifier representing each player, each time a player leaves the empty index is reused) but using a 0-255 identifier leaves us with no way to deduce what room the message is for, since every room uses the 0-255 indexes for players, so we would have to send a room identifier too (1 byte, 0-255 also), so this only really makes sense to do with arrays of player IDs, where we could send the room ID along with it.
    example: array of 10 hashed socketIds = 40 bytes. array of 10 player indexes with room ID = 11 bytes
    heck, even on messages for 1 receiver, sending an index with a room identifier is 2 bytes compared to a 4 byte hashed socketId, but that may not be worth the trouble right now
        or instead of sending an array of hashIds, send out an array of spriteIds if its the trusted authority to do so. this lowers it from 4 bytes per entry to 1-2 bytes

    this may be a little tough, but instead of sending the precise position of an object, send the change between the last sent position and the current position. sending the full position could be like [5000, 5000], but sending the difference would be [50, 50], 1 byte each instead of 2 bytes

helpful knowledge:
    using socket.emit() with nothing like shown, it is 4 bytes. if you do socket.emit(1) (tag = 1) it is 5 bytes, if you do socket.emit(1, [1,1,1,1,1]) it is 17 bytes, even though the data in the params is only 10 bytes, the other 7 must be for reconstructing it as an array or something